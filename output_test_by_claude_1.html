<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Irregular Verbs Trainer</title>
    <style>
        /* Reset e variabili CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --background: #f8fafc;
            --surface: #ffffff;
            --surface-hover: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-color: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --radius: 8px;
            --radius-lg: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        /* Navigation */
        nav {
            background: var(--primary-color);
            
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
            position: relative;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .nav-links {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 12px 0;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--background);
            transition: all 0.2s ease;
            padding: 8px 12px;
            border-radius: var(--radius);
            min-width: 60px;
        }

        .nav-item:hover {
            color: var(--primary-color);
            background: var(--surface-hover);
        }

        .nav-item img {
            width: 24px;
            height: 24px;
            margin-bottom: 4px;
        }

        .nav-item span {
            font-size: 12px;
            font-weight: 500;
        }

        /* Container principale */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 16px;
        }

        /* Settings Panel */
        .settings-panel {
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            padding: 24px;
            margin-bottom: 20px;
        }

        .settings-panel.hidden {
            display: none;
        }

        .settings-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 24px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 16px;
            background: var(--surface);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgb(37 99 235 / 0.1);
        }

        .btn-primary {
            width: 100%;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 8px;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* Control Panel */
        .control-panel {
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 16px;
            margin-bottom: 20px;
            position: sticky;
            top: 80px;
            z-index: 50;
        }

        .control-panel.hidden {
            display: none;
        }

        .control-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }

        .timer {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-color);
            padding: 8px 16px;
            background: rgb(37 99 235 / 0.1);
            border-radius: var(--radius);
            min-width: 120px;
            text-align: center;
        }

        .timer.warning {
            color: var(--warning-color);
            background: rgb(245 158 11 / 0.1);
        }

        .timer.danger {
            color: var(--error-color);
            background: rgb(239 68 68 / 0.1);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .score {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            padding: 8px 16px;
            background: var(--surface-hover);
            border-radius: var(--radius);
        }

        .btn-control {
            padding: 10px 16px;
            border: none;
            border-radius: var(--radius);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-check {
            background: var(--success-color);
            color: white;
        }

        .btn-check:hover {
            background: #059669;
        }

        .btn-pause {
            background: var(--warning-color);
            color: white;
        }

        .btn-pause:hover {
            background: #d97706;
        }

        .btn-give-up {
            background: var(--error-color);
            color: white;
        }

        .btn-give-up:hover {
            background: #dc2626;
        }

        .btn-secondary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        .btn-control:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Test Table */
        .test-container {
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .test-table {
            width: 100%;
            border-collapse: collapse;
        }

        .test-table th {
            background: var(--primary-color);
            color: white;
            padding: 16px 12px;
            font-weight: 600;
            font-size: 14px;
            text-align: center;
            border: none;
        }

        .test-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            text-align: center;
            vertical-align: middle;
        }

        .test-table tr:last-child td {
            border-bottom: none;
        }

        .test-table tr:nth-child(even) {
            background: var(--surface-hover);
        }

        .verb-input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 16px;
            text-align: center;
            background: var(--surface);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .verb-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgb(37 99 235 / 0.1);
        }

        .verb-input.correct {
            border-color: var(--success-color);
            background: rgb(16 185 129 / 0.1);
            color: var(--success-color);
        }

        .verb-input.wrong {
            border-color: var(--error-color);
            background: rgb(239 68 68 / 0.1);
            color: var(--error-color);
        }

        .verb-input.revealed {
            background: rgb(100 116 139 / 0.1);
            color: var(--text-secondary);
        }

        .given-word {
            font-weight: 600;
            color: var(--text-primary);
            background: rgb(37 99 235 / 0.05);
            padding: 10px 12px;
            border-radius: var(--radius);
            border: 2px solid rgb(37 99 235 / 0.2);
        }

        /* Modal per messaggi */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: 32px 24px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            max-width: 400px;
            width: 100%;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .modal-text {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .modal.error .modal-title {
            color: var(--error-color);
        }

        .modal.success .modal-title {
            color: var(--success-color);
        }

        .modal.warning .modal-title {
            color: var(--warning-color);
        }
        /* ...existing code... */
        .main-actions {
            display: flex;
            flex-direction: row;
            gap: 8px;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                padding: 8px 6px;
            }

            .settings-panel, .control-panel, .test-container {
                margin-bottom: 5px;
                top: 65px;
                padding: 6px;
                }

            .control-row {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }

            .control-row > * {
                width: 100%;
                text-align: center;
                justify-content: center;
            }

            .timer {
                order: -1;
                font-size: 15px;
                padding: 5px;
            }
            .score {
                font-size: 12px;
                padding: 5px;
            }
            .btn-control {
                font-size: 14px;
                padding: 5px;
            }
            .btn-give-up, .btn-pause, .btn-check {
                
                font-size: 12px;
                padding: 3px;
                /* center horizontally */
                width: 100%;
                align-items: center;
                justify-content: center;
                text-align: center;
            }
            .main-actions {
                flex-direction: row;
                width: 100%;
                justify-content: center;
                gap: 4px;
            }
            .main-actions .btn-control {
                flex: 1 1 0;
                min-width: 0;
                padding: 3px;
                font-size: 12px;
            }
            

            .test-table th,
            .test-table td {
                padding: 8px 4px;
                font-size: 14px;
            }

            .test-table th {
                font-size: 12px;
            }

            .verb-input {
                font-size: 16px;
                padding: 8px;
            }

            .nav-item span {
                font-size: 11px;
            }
            
            .nav-links {
            
                padding: 0 0;
            }
        }

        @media (max-width: 480px) {
            .test-table {
                font-size: 12px;
            }

            .test-table th {
                padding: 12px 2px;
                font-size: 11px;
            }

            .test-table td {
                padding: 8px 2px;
            }

            .verb-input {
                padding: 6px 4px;
                font-size: 14px;
            }

            .given-word {
                padding: 6px 4px;
                font-size: 14px;
            }
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-out {
            animation: fadeOut 2s ease-in-out 2s forwards;
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="nav-links">
                <a href="index.html" class="nav-item">
                    <img src="images/home.png" alt="Home">
                    <span>Home</span>
                </a>
                <a href="study_area.html" class="nav-item">
                    <img src="images/learn.png" alt="Learn">
                    <span>Learn</span>
                </a>
                <a href="irregular_verbs.html" class="nav-item">
                    <img src="images/train.png" alt="Train">
                    <span>Train</span>
                </a>
                <a href="irregular_verbs_verifica.html" class="nav-item">
                    <img src="images/test.png" alt="Test">
                    <span>Test</span>
                </a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <!-- Settings Panel -->
        <div id="settings-panel" class="settings-panel">
            <h2 class="settings-title">⚙️ Impostazioni Test</h2>
            
            <div class="form-group">
                <label for="difficulty" class="form-label">🎯 Livello di difficoltà</label>
                <select id="difficulty" class="form-select">
                    <option value="easy">Facile (A2) - Ket Exam</option>
                    <option value="medium">Medio (B1) - Pet Exam</option>
                    <option value="hard">Difficile (B2/C1) - First Exam</option>
                </select>
            </div>

            <div class="form-group">
                <label for="time" class="form-label">⏰ Tempo a disposizione</label>
                <select id="time" class="form-select">
                    <option value="1">1 minuto</option>
                    <option value="15">15 minuti</option>
                    <option value="30">30 minuti</option>
                    <option value="60">60 minuti</option>
                </select>
            </div>

            <div class="form-group">
                <label for="numberOfVerbs" class="form-label">📝 Numero di verbi</label>
                <select id="numberOfVerbs" class="form-select">
                    <option value="5">5 verbi</option>
                    <option value="10">10 verbi</option>
                    <option value="15">15 verbi</option>
                    <option value="20">20 verbi</option>
                    <option value="50">50 verbi</option>
                </select>
            </div>

            <button onclick="applySettings()" class="btn-primary">
                🚀 Inizia il Test
            </button>
        </div>

        <!-- Control Panel -->
        <div id="control-panel" class="control-panel hidden">
            <div class="control-row">
                <div id="timer" class="timer">0s</div>
                <div id="score" class="score">Score: 0/10</div>
                <div class="main-actions">
                    <button id="toggle-timer" onclick="toggleTimer()" class="btn-control btn-pause">
                        ⏸️ Pausa
                    </button>
                    <button id="check-answers" onclick="checkAnswers()" class="btn-control btn-check">
                        ✅ Controlla
                    </button>
                    <button id="give-up" onclick="giveUp()" class="btn-control btn-give-up">
                        😓 Arrendi
                    </button>
                </div>
                <button id="start-again" onclick="startAgain()" class="btn-control btn-secondary hidden">
                    🔄 Riprova
                </button>
                <button id="settings-again" onclick="toggleSettings()" class="btn-control btn-secondary hidden">
                    ⚙️ Impostazioni
                </button>
            </div>
        </div>

        <!-- Test Table -->
        <div id="test-container" class="test-container">
            <div id="test"></div>
        </div>
    </div>

    <!-- Modal per messaggi -->
    <div id="message-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="modal-title" class="modal-title"></h3>
            <p id="modal-text" class="modal-text"></p>
        </div>
    </div>

    <script>
        // Add this variable at the top with other global variables
        let randomColumnIndex = 0;
        let isFirstTime = true;
        let selectedVerbs = [];
        let score = 0;
        let isTimerRunning = true;
        let stopwatchInterval;
        let elapsedTime = 0;
        let maxTime;

        const verbs = [
            { Translation: "svegliarsi (stato)", "Base Form": "awake", "Simple Past": "awoke", "Past Participle": "awoken" },
			{ Translation: "essere", "Base Form": "be", "Simple Past": "was - were", "Past Participle": "been" },
			{ Translation: "sopportare / sostenere", "Base Form": "bear", "Simple Past": "bore", "Past Participle": "borne" },
			{ Translation: "battere / sconfiggere", "Base Form": "beat", "Simple Past": "beat", "Past Participle": "beaten" },
			{ Translation: "diventare", "Base Form": "become", "Simple Past": "became", "Past Participle": "become" },
			{ Translation: "iniziare / cominciare", "Base Form": "begin", "Simple Past": "began", "Past Participle": "begun" },
			{ Translation: "piegare", "Base Form": "bend", "Simple Past": "bent", "Past Participle": "bent" },
			{ Translation: "scommettere", "Base Form": "bet", "Simple Past": "bet", "Past Participle": "bet" },
			{ Translation: "fare un’offerta", "Base Form": "bid", "Simple Past": "bid", "Past Participle": "bid" },
			{ Translation: "legare / bendare", "Base Form": "bind", "Simple Past": "bound", "Past Participle": "bound" },
			{ Translation: "mordere", "Base Form": "bite", "Simple Past": "bit", "Past Participle": "bitten" },
			{ Translation: "sanguinare", "Base Form": "bleed", "Simple Past": "bled", "Past Participle": "bled" },
			{ Translation: "soffiare", "Base Form": "blow", "Simple Past": "blew", "Past Participle": "blown" },
			{ Translation: "rompere", "Base Form": "break", "Simple Past": "broke", "Past Participle": "broken" },
			{ Translation: "allevare", "Base Form": "breed", "Simple Past": "bred", "Past Participle": "bred" },
			{ Translation: "portare", "Base Form": "bring", "Simple Past": "brought", "Past Participle": "brought" },
			{ Translation: "trasmettere", "Base Form": "broadcast", "Simple Past": "broadcast", "Past Participle": "broadcast" },
			{ Translation: "costruire", "Base Form": "build", "Simple Past": "built", "Past Participle": "built" },
			{ Translation: "bruciare", "Base Form": "burn", "Simple Past": "burned / burnt", "Past Participle": "burned / burnt" },
			{ Translation: "esplodere", "Base Form": "burst", "Simple Past": "burst", "Past Participle": "burst" },
			{ Translation: "comprare", "Base Form": "buy", "Simple Past": "bought", "Past Participle": "bought" },
			{ Translation: "gettare", "Base Form": "cast", "Simple Past": "cast", "Past Participle": "cast" },
			{ Translation: "prendere / afferrare", "Base Form": "catch", "Simple Past": "caught", "Past Participle": "caught" },
			{ Translation: "scegliere", "Base Form": "choose", "Simple Past": "chose", "Past Participle": "chosen" },
			{ Translation: "attaccarsi", "Base Form": "cling", "Simple Past": "clung", "Past Participle": "clung" },
			{ Translation: "venire", "Base Form": "come", "Simple Past": "came", "Past Participle": "come" },
			{ Translation: "costare", "Base Form": "cost", "Simple Past": "cost", "Past Participle": "cost" },
			{ Translation: "strisciare", "Base Form": "creep", "Simple Past": "crept", "Past Participle": "crept" },
			{ Translation: "tagliare", "Base Form": "cut", "Simple Past": "cut", "Past Participle": "cut" },
			{ Translation: "distribuire le carte", "Base Form": "deal", "Simple Past": "dealt", "Past Participle": "dealt" },
			{ Translation: "scavare", "Base Form": "dig", "Simple Past": "dug", "Past Participle": "dug" },
			{ Translation: "tuffarsi / immergersi", "Base Form": "dive", "Simple Past": "dived / dove", "Past Participle": "dived" },
			{ Translation: "fare/ agire", "Base Form": "do", "Simple Past": "did", "Past Participle": "done" },
			{ Translation: "disegnare", "Base Form": "draw", "Simple Past": "drew", "Past Participle": "drawn" },
			{ Translation: "sognare", "Base Form": "dream", "Simple Past": "dreamed / dreamt", "Past Participle": "dreamed / dreamt" },
			{ Translation: "bere", "Base Form": "drink", "Simple Past": "drank", "Past Participle": "drunk" },
			{ Translation: "guidare", "Base Form": "drive", "Simple Past": "drove", "Past Participle": "driven" },
			{ Translation: "mangiare", "Base Form": "eat", "Simple Past": "ate", "Past Participle": "eaten" },
			{ Translation: "cadere", "Base Form": "fall", "Simple Past": "fell", "Past Participle": "fallen" },
			{ Translation: "nutrire", "Base Form": "feed", "Simple Past": "fed", "Past Participle": "fed" },
			{ Translation: "sentire", "Base Form": "feel", "Simple Past": "felt", "Past Participle": "felt" },
			{ Translation: "combattere / lottare", "Base Form": "fight", "Simple Past": "fought", "Past Participle": "fought" },
			{ Translation: "trovare / scoprire", "Base Form": "find", "Simple Past": "found", "Past Participle": "found" },
			{ Translation: "calzare / addattarsi", "Base Form": "fit", "Simple Past": "fitted / fit", "Past Participle": "fitted / fit" },
			{ Translation: "fuggire", "Base Form": "flee", "Simple Past": "fled", "Past Participle": "fled" },
			{ Translation: "scagliare / lanciare", "Base Form": "fling", "Simple Past": "flung", "Past Participle": "flung" },
			{ Translation: "volare", "Base Form": "fly", "Simple Past": "flew", "Past Participle": "flown" },
			{ Translation: "proibire / vietare", "Base Form": "forbid", "Simple Past": "forbade", "Past Participle": "forbidden" },
			{ Translation: "dimenticare", "Base Form": "forget", "Simple Past": "forgot", "Past Participle": "forgotten" },
			{ Translation: "perdonare", "Base Form": "forgive", "Simple Past": "forgave", "Past Participle": "forgiven" },
			{ Translation: "abbandonare", "Base Form": "forsake", "Simple Past": "forsook", "Past Participle": "forsaken" },
			{ Translation: "congelare / gelare", "Base Form": "freeze", "Simple Past": "froze", "Past Participle": "frozen" },
			{ Translation: "ricevere / ottenere", "Base Form": "get", "Simple Past": "got", "Past Participle": "got / gotten" },
			{ Translation: "dare", "Base Form": "give", "Simple Past": "gave", "Past Participle": "given" },
			{ Translation: "andare", "Base Form": "go", "Simple Past": "went", "Past Participle": "gone" },
			{ Translation: "macinare", "Base Form": "grind", "Simple Past": "ground", "Past Participle": "ground" },
			{ Translation: "crescere / coltivare", "Base Form": "grow", "Simple Past": "grew", "Past Participle": "grown" },
			{ Translation: "appendere", "Base Form": "hang", "Simple Past": "hung", "Past Participle": "hung" },
			{ Translation: "sentire / udire", "Base Form": "hear", "Simple Past": "heard", "Past Participle": "heard" },
			{ Translation: "nascondere", "Base Form": "hide", "Simple Past": "hid", "Past Participle": "hidden" },
			{ Translation: "colpire", "Base Form": "hit", "Simple Past": "hit", "Past Participle": "hit" },
			{ Translation: "stringere / tenere", "Base Form": "hold", "Simple Past": "held", "Past Participle": "held" },
			{ Translation: "far male / ferire", "Base Form": "hurt", "Simple Past": "hurt", "Past Participle": "hurt" },
			{ Translation: "tenere / mantenere", "Base Form": "keep", "Simple Past": "kept", "Past Participle": "kept" },
			{ Translation: "inginocchiarsi", "Base Form": "kneel", "Simple Past": "knelt / kneeled", "Past Participle": "knelt / kneeled" },
			{ Translation: "sapere / conoscere", "Base Form": "know", "Simple Past": "knew", "Past Participle": "known" },
			{ Translation: "stendere", "Base Form": "lay", "Simple Past": "laid", "Past Participle": "laid" },
			{ Translation: "guidare / condurre", "Base Form": "lead", "Simple Past": "led", "Past Participle": "led" },
			{ Translation: "imparare", "Base Form": "learn", "Simple Past": "learned / learnt", "Past Participle": "learned / learnt" },
			{ Translation: "lasciare / partire", "Base Form": "leave", "Simple Past": "left", "Past Participle": "left" },
			{ Translation: "prestare", "Base Form": "lend", "Simple Past": "lent", "Past Participle": "lent" },
			{ Translation: "permettere / lasciare", "Base Form": "let", "Simple Past": "let", "Past Participle": "let" },
			{ Translation: "essere sdraiato", "Base Form": "lie", "Simple Past": "lay", "Past Participle": "lain" },
			{ Translation: "accendere / illuminare", "Base Form": "light", "Simple Past": "lit / lighted", "Past Participle": "lit / lighted" },
			{ Translation: "perdere", "Base Form": "lose", "Simple Past": "lost", "Past Participle": "lost" },
			{ Translation: "fare /fabbricare", "Base Form": "make", "Simple Past": "made", "Past Participle": "made" },
			{ Translation: "significare / intendere", "Base Form": "mean", "Simple Past": "meant", "Past Participle": "meant" },
			{ Translation: "incontrare / incontrarsi", "Base Form": "meet", "Simple Past": "met", "Past Participle": "met" },
			{ Translation: "sbagliare a scrivere", "Base Form": "misspell", "Simple Past": "misspelt / misspelled", "Past Participle": "misspelt / misspelled" },
			{ Translation: "sbagliare", "Base Form": "mistake", "Simple Past": "mistook", "Past Participle": "mistaken" },
			{ Translation: "dominare", "Base Form": "overcome", "Simple Past": "overcame", "Past Participle": "overcome" },
			{ Translation: "sorpassare", "Base Form": "overtake", "Simple Past": "overtook", "Past Participle": "overtaken" },
			{ Translation: "pagare", "Base Form": "pay", "Simple Past": "paid", "Past Participle": "paid" },
			{ Translation: "dichiararsi", "Base Form": "plead", "Simple Past": "pleaded / pled", "Past Participle": "pleaded / pled" },
			{ Translation: "provare", "Base Form": "prove", "Simple Past": "proved", "Past Participle": "proved / proven" },
			{ Translation: "mettere", "Base Form": "put", "Simple Past": "put", "Past Participle": "put" },
			{ Translation: "smettere / abbandonare", "Base Form": "quit", "Simple Past": "quit", "Past Participle": "quit" },
			{ Translation: "leggere", "Base Form": "read", "Simple Past": "read", "Past Participle": "read" },
			{ Translation: "cavalcare", "Base Form": "ride", "Simple Past": "rode", "Past Participle": "ridden" },
			{ Translation: "squillare", "Base Form": "ring", "Simple Past": "rang", "Past Participle": "rung" },
			{ Translation: "aumentare / sorgere", "Base Form": "rise", "Simple Past": "rose", "Past Participle": "risen" },
			{ Translation: "correre", "Base Form": "run", "Simple Past": "ran", "Past Participle": "run" },
			{ Translation: "dire", "Base Form": "say", "Simple Past": "said", "Past Participle": "said" },
			{ Translation: "vedere", "Base Form": "see", "Simple Past": "saw", "Past Participle": "seen" },
			{ Translation: "cercare", "Base Form": "seek", "Simple Past": "sought", "Past Participle": "sought" },
			{ Translation: "vendere", "Base Form": "sell", "Simple Past": "sold", "Past Participle": "sold" },
			{ Translation: "mandare / spedire", "Base Form": "send", "Simple Past": "sent", "Past Participle": "sent" },
			{ Translation: "impostare / mettere", "Base Form": "set", "Simple Past": "set", "Past Participle": "set" },
			{ Translation: "cucire", "Base Form": "sew", "Simple Past": "sewed", "Past Participle": "sewed / sewn" },
			{ Translation: "agitare / scuotere", "Base Form": "shake", "Simple Past": "shook", "Past Participle": "shaken" },
			{ Translation: "brillare / risplendere", "Base Form": "shine", "Simple Past": "shone", "Past Participle": "shone" },
			{ Translation: "ferrare", "Base Form": "shoe", "Simple Past": "shod", "Past Participle": "shod" },
			{ Translation: "sparare", "Base Form": "shoot", "Simple Past": "shot", "Past Participle": "shot" },
			{ Translation: "mostrare / esibire", "Base Form": "show", "Simple Past": "showed", "Past Participle": "shown" },
			{ Translation: "restringersi", "Base Form": "shrink", "Simple Past": "shrank", "Past Participle": "shrunk" },
			{ Translation: "chiudere", "Base Form": "shut", "Simple Past": "shut", "Past Participle": "shut" },
			{ Translation: "cantare", "Base Form": "sing", "Simple Past": "sang", "Past Participle": "sung" },
			{ Translation: "affondare", "Base Form": "sink", "Simple Past": "sank", "Past Participle": "sunk" },
			{ Translation: "sedersi / sedere", "Base Form": "sit", "Simple Past": "sat", "Past Participle": "sat" },
			{ Translation: "dormire", "Base Form": "sleep", "Simple Past": "slept", "Past Participle": "slept" },
			{ Translation: "odorare / annusare", "Base Form": "smell", "Simple Past": "smelled / smelt", "Past Participle": "smelled / smelt" },
			{ Translation: "scorrere / scivolare", "Base Form": "slide", "Simple Past": "slid", "Past Participle": "slid" },
			{ Translation: "parlare", "Base Form": "speak", "Simple Past": "spoke", "Past Participle": "spoken" },
			{ Translation: "andare veloce / accelerare", "Base Form": "speed", "Simple Past": "sped", "Past Participle": "sped" },
			{ Translation: "sillabare", "Base Form": "spell", "Simple Past": "spelled / spelt", "Past Participle": "spelled / spelt" },
			{ Translation: "spendere", "Base Form": "spend", "Simple Past": "spent", "Past Participle": "spent" },
			{ Translation: "versare / rovesciare", "Base Form": "spill", "Simple Past": "spilt / spilled", "Past Participle": "spilt / spilled" },
			{ Translation: "sputare", "Base Form": "spit", "Simple Past": "spat", "Past Participle": "spat" },
			{ Translation: "diffondere", "Base Form": "spread", "Simple Past": "spread", "Past Participle": "spread" },
			{ Translation: "saltare", "Base Form": "spring", "Simple Past": "sprang", "Past Participle": "sprung" },
			{ Translation: "alzarsi / stare in piedi", "Base Form": "stand", "Simple Past": "stood", "Past Participle": "stood" },
			{ Translation: "rubare", "Base Form": "steal", "Simple Past": "stole", "Past Participle": "stolen" },
			{ Translation: "incollare", "Base Form": "stick", "Simple Past": "stuck", "Past Participle": "stuck" },
			{ Translation: "pungere", "Base Form": "sting", "Simple Past": "stung", "Past Participle": "stung" },
			{ Translation: "puzzare", "Base Form": "stink", "Simple Past": "stank", "Past Participle": "stunk" },
			{ Translation: "colpire / battere", "Base Form": "strike", "Simple Past": "struck", "Past Participle": "struck" },
			{ Translation: "giurare", "Base Form": "swear", "Simple Past": "swore", "Past Participle": "sworn" },
			{ Translation: "nuotare", "Base Form": "swim", "Simple Past": "swam", "Past Participle": "swum" },
			{ Translation: "oscillare", "Base Form": "swing", "Simple Past": "swang", "Past Participle": "swung" },
			{ Translation: "prendere", "Base Form": "take", "Simple Past": "took", "Past Participle": "taken" },
			{ Translation: "insegnare", "Base Form": "teach", "Simple Past": "taught", "Past Participle": "taught" },
			{ Translation: "strappare", "Base Form": "tear", "Simple Past": "tore", "Past Participle": "torn" },
			{ Translation: "raccontare", "Base Form": "tell", "Simple Past": "told", "Past Participle": "told" },
			{ Translation: "pensare", "Base Form": "think", "Simple Past": "thought", "Past Participle": "thought" },
			{ Translation: "tirare / lanciare", "Base Form": "throw", "Simple Past": "threw", "Past Participle": "thrown" },
			{ Translation: "spingere", "Base Form": "thrust", "Simple Past": "thrust", "Past Participle": "thrust" },
			{ Translation: "calpestare", "Base Form": "tread", "Simple Past": "trod", "Past Participle": "trodden" },
			{ Translation: "capire", "Base Form": "understand", "Simple Past": "understood", "Past Participle": "understood" },
			{ Translation: "turbare / arrabbiare", "Base Form": "upset", "Simple Past": "upset", "Past Participle": "upset" },
			{ Translation: "svegliare / svegliarsi", "Base Form": "wake", "Simple Past": "woke", "Past Participle": "woken" },
			{ Translation: "indossare", "Base Form": "wear", "Simple Past": "wore", "Past Participle": "worn" },
			{ Translation: "intrecciare", "Base Form": "weave", "Simple Past": "wove", "Past Participle": "woven" },
			{ Translation: "piangere", "Base Form": "weep", "Simple Past": "wept", "Past Participle": "wept" },
			{ Translation: "vincere", "Base Form": "win", "Simple Past": "won", "Past Participle": "won" },
			{ Translation: "avvolgere", "Base Form": "wind", "Simple Past": "wound", "Past Participle": "wound" },
			{ Translation: "torcere/ strizzare", "Base Form": "wring", "Simple Past": "wrung", "Past Participle": "wrung" },
			{ Translation: "scrivere", "Base Form": "write", "Simple Past": "wrote", "Past Participle": "written" }
        ];

        // Inizializzazione
        window.onload = function() {
            loadSettings();
            if (!localStorage.getItem("difficulty")) {
                isFirstTime = true;
            } else {
                isFirstTime = false;
            }
            showSettings();
        }
        // Add this helper function after the existing functions
        function getRandomColumn() {
            const columns = ['translation', 'base', 'past', 'participle'];
            return columns[Math.floor(Math.random() * columns.length)];
        }

        function showSettings() {
            document.getElementById("settings-panel").classList.remove("hidden");
            document.getElementById("control-panel").classList.add("hidden");
            document.getElementById("test").innerHTML = "";
            hideAllControlButtons();
        }

        function hideSettings() {
            document.getElementById("settings-panel").classList.add("hidden");
            document.getElementById("control-panel").classList.remove("hidden");
        }

        function hideAllControlButtons() {
            document.getElementById("check-answers").classList.add("hidden");
            document.getElementById("give-up").classList.add("hidden");
            document.getElementById("start-again").classList.add("hidden");
            document.getElementById("settings-again").classList.add("hidden");
            document.getElementById("toggle-timer").classList.add("hidden");
        }

        function showGameButtons() {
            document.getElementById("check-answers").classList.remove("hidden");
            document.getElementById("give-up").classList.remove("hidden");
            document.getElementById("toggle-timer").classList.remove("hidden");
        }

        function showEndGameButtons() {
            document.getElementById("start-again").classList.remove("hidden");
            document.getElementById("settings-again").classList.remove("hidden");
            hideAllControlButtons();
        }

        function applySettings() {
            const difficulty = document.getElementById("difficulty").value;
            const time = document.getElementById("time").value;
            const numberOfVerbs = document.getElementById("numberOfVerbs").value;

            // Salva impostazioni
            localStorage.setItem("difficulty", difficulty);
            localStorage.setItem("time", time);
            localStorage.setItem("numberOfVerbs", numberOfVerbs);

            hideSettings();
            updateScoreDisplay(numberOfVerbs);
            showGameButtons();
            startGame();
        }

        function toggleSettings() {
            showSettings();
            loadSettings();
        }

        function loadSettings() {
            const storedNumber = localStorage.getItem("numberOfVerbs");
            const numberOfVerbs = storedNumber ? parseInt(storedNumber) : 10;
            document.getElementById("numberOfVerbs").value = numberOfVerbs;
            updateScoreDisplay(numberOfVerbs);

            const storedDifficulty = localStorage.getItem("difficulty");
            const difficulty = storedDifficulty ? storedDifficulty : "medium";
            document.getElementById("difficulty").value = difficulty;

            const storedTime = localStorage.getItem("time");
            const time = storedTime ? storedTime : "30";
            document.getElementById("time").value = time;
        }

        function updateScoreDisplay(numberOfVerbs) {
            const maxScore = numberOfVerbs || document.getElementById("numberOfVerbs").value || 10;
            document.getElementById("score").innerText = `Score: 0/${maxScore}`;
        }

        function filterVerbs(level) {
            let easyVerbs = [
                            "be", "become", "begin", "break", "bring", "build", "burn", "buy", "catch", "choose",
                            "come", "cut", "do", "draw", "dream", "drink", "drive", "eat", "fall", "feel",
                            "find", "forget", "get", "give", "go", "grow", "have", "hear", "hit", "hurt",
                            "keep", "know", "learn", "leave", "let", "lose", "make", "meet", "pay", "put",
                            "read", "ride", "run", "say", "see", "sell", "send", "sing", "sit", "sleep",
                            "speak", "spend", "stand", "swim", "take", "teach", "tell", "think", "understand",
                            "wake", "wear", "win", "write"
            ];

            let mediumVerbs = [
								"be", "beat", "become", "begin", "bend", "bite", "blow", "break", "bring", "build", "burn", "buy",
								"catch", "choose", "come", "cost", "cut", "deal", "dig", "do", "draw", "dream", "drink", "drive", "eat",
								"fall", "feed", "feel", "fight", "find", "fly", "forbid", "forget", "forgive", "freeze", "get", "give",
								"go", "grow", "hang", "have", "hear", "hide", "hit", "hold", "hurt", "keep", "kneel", "know", "lay", "lead",
								"learn", "leave", "lend", "let", "lie", "light", "lose", "make", "mean", "meet", "pay", "put", "read",
								"ride", "ring", "rise", "run", "say", "see", "sell", "send", "set", "sew", "shake", "shine", "shoot",
								"show", "shut", "sing", "sink", "sit", "sleep", "smell", "speak", "spell", "spend", "spoil", "stand",
								"steal", "stick", "strike", "sweep", "swim", "swing", "take", "teach", "tear", "tell", "think", "throw",
								"understand", "wake", "wear", "win", "write"
            ];

            let hardVerbs = [
                            "awake", "be", "bear", "beat", "become", "begin", "bend", "bet", "bid", "bind",
                            "bite", "bleed", "blow", "break", "breed", "bring", "broadcast", "build", "burn", "burst",
                            "buy", "cast", "catch", "choose", "cling", "come", "cost", "creep", "cut", "deal",
                            "dig", "dive", "do", "draw", "dream", "drink", "drive", "eat", "fall", "feed",
                            "feel", "fight", "find", "fit", "flee", "fling", "fly", "forbid", "forget", "forgive",
                            "forsake", "freeze", "get", "give", "go", "grind", "grow", "have", "hang", "hear",
                            "hide", "hit", "hold", "hurt", "keep", "kneel", "know", "lay", "lead", "learn",
                            "leave", "lend", "let", "lie", "light", "lose", "make", "mean", "meet", "misspell",
                            "mistake", "overcome", "overtake", "pay", "plead", "prove", "put", "quit", "read", "ride",
                            "ring", "rise", "run", "say", "see", "seek", "sell", "send", "set", "sew",
                            "shake", "shine", "shoe", "shoot", "show", "shrink", "shut", "sing", "sink", "sit",
                            "sleep", "smell", "slide", "speak", "speed", "spell", "spend", "spill", "spit", "spoil",
                            "spread", "spring", "stand", "steal", "stick", "sting", "stink", "strike", "swear", "sweep",
                            "swim", "swing", "take", "teach", "tear", "tell", "think", "throw", "thrust", "tread",
                            "understand", "upset", "wake", "wear", "weave", "weep", "win", "wind", "wring", "write"
            ];

            return verbs.filter(verb => {
                if (level === "easy") {
                    return easyVerbs.includes(verb["Base Form"]);
                } else if (level === "medium") {
                    return mediumVerbs.includes(verb["Base Form"]);
                } else if (level === "hard") {
                    return hardVerbs.includes(verb["Base Form"]);
                }
                return true;
            });
        }

        function startStopwatch() {
            let remainingTime = elapsedTime || maxTime;
            updateTimerDisplay(remainingTime);

            stopwatchInterval = setInterval(() => {
                remainingTime--;
                elapsedTime = remainingTime;
                updateTimerDisplay(remainingTime);

                // Cambia colore timer in base al tempo rimasto
                const timerElement = document.getElementById("timer");
                const percentage = remainingTime / maxTime;
                
                if (percentage > 0.5) {
                    timerElement.className = "timer";
                } else if (percentage > 0.2) {
                    timerElement.className = "timer warning";
                } else {
                    timerElement.className = "timer danger";
                }

                if (remainingTime <= 0) {
                    clearInterval(stopwatchInterval);
                    giveUp();
                    showModal("⏰ Tempo Scaduto!", "Il tempo a disposizione è terminato!", "error");
                }
            }, 1000);
        }

        function updateTimerDisplay(secondsLeft) {
            const minutes = Math.floor(secondsLeft / 60);
            const seconds = secondsLeft % 60;
            document.getElementById("timer").innerText = `${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
        }

        function toggleTimer() {
            const button = document.getElementById("toggle-timer");
            if (isTimerRunning) {
                clearInterval(stopwatchInterval);
                button.innerHTML = "▶️ Riprendi";
                button.className = "btn-control btn-secondary";
            } else {
                startStopwatch();
                button.innerHTML = "⏸️ Pausa";
                button.className = "btn-control btn-pause";
            }
            isTimerRunning = !isTimerRunning;
        }

        function stopStopwatch() {
            clearInterval(stopwatchInterval);
        }

        // Replace the existing startGame() function with this modified version
        function startGame() {
            const difficulty = localStorage.getItem("difficulty") || "medium";
            const time = parseInt(localStorage.getItem("time")) || 30;
            const numberOfVerbs = parseInt(localStorage.getItem("numberOfVerbs")) || 10;

            maxTime = time * 60;
            elapsedTime = maxTime;

            const filteredVerbs = filterVerbs(difficulty);
            selectedVerbs = getRandomVerbsFromList(filteredVerbs, numberOfVerbs);

            updateScoreDisplay(numberOfVerbs);

            let tableHTML = `
                <table class="test-table">
                    <thead>
                        <tr> 
                            <th>Translation</th>
                            <th>Base Form</th>
                            <th>Simple Past</th>
                            <th>Past Participle</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            selectedVerbs.forEach(verb => {
                // Get random column to show for this row
                const shownColumn = getRandomColumn();
                
                tableHTML += `<tr>`;
                
                // Translation column
                if (shownColumn === 'translation') {
                    tableHTML += `<td class="given-word">${verb.Translation}</td>`;
                } else {
                    tableHTML += `<td><input type="text" class="verb-input" data-verb="${verb.Translation}" data-form="translation" placeholder="Translation"></td>`;
                }
                
                // Base Form column
                if (shownColumn === 'base') {
                    tableHTML += `<td class="given-word">${verb['Base Form']}</td>`;
                } else {
                    tableHTML += `<td><input type="text" class="verb-input" data-verb="${verb['Base Form']}" data-form="base" placeholder="Base Form"></td>`;
                }
                
                // Simple Past column
                if (shownColumn === 'past') {
                    tableHTML += `<td class="given-word">${verb['Simple Past']}</td>`;
                } else {
                    tableHTML += `<td><input type="text" class="verb-input" data-verb="${verb['Simple Past']}" data-form="past" placeholder="Simple Past"></td>`;
                }
                
                // Past Participle column
                if (shownColumn === 'participle') {
                    tableHTML += `<td class="given-word">${verb['Past Participle']}</td>`;
                } else {
                    tableHTML += `<td><input type="text" class="verb-input" data-verb="${verb['Past Participle']}" data-form="participle" placeholder="Past Participle"></td>`;
                }
                
                tableHTML += `</tr>`;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;

            document.getElementById("test").innerHTML = tableHTML;
            startStopwatch();
            
            // Focus sul primo input
            const firstInput = document.querySelector('.verb-input');
            if (firstInput) {
                firstInput.focus();
            }

            // Aggiungi event listeners per navigazione con Tab/Enter
            addInputEventListeners();
        }
        function addInputEventListeners() {
            const inputs = document.querySelectorAll('.verb-input');
            inputs.forEach((input, index) => {
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === 'Tab') {
                        e.preventDefault();
                        const nextIndex = (index + 1) % inputs.length;
                        inputs[nextIndex].focus();
                    }
                });

                // Auto-check mentre si digita
                input.addEventListener('input', function() {
                    const userAnswer = this.value.trim().toLowerCase();
                    const correctAnswer = this.getAttribute('data-verb').toLowerCase();
                    
                    // Rimuovi classi precedenti
                    this.classList.remove('correct', 'wrong');
                    
                    if (userAnswer && userAnswer === correctAnswer) {
                        this.classList.add('correct');
                    }
                });
            });
        }

        function getRandomVerbsFromList(verbsList, numberOfVerbs) {
            const shuffled = verbsList.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, numberOfVerbs);
        }

        function checkAnswers() {
            const inputs = document.querySelectorAll('.verb-input');
            let correctAnswers = 0;
            let totalAnswers = inputs.length;

            inputs.forEach(input => {
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = input.getAttribute('data-verb').toLowerCase();
                
                // Rimuovi classi precedenti
                input.classList.remove('correct', 'wrong', 'revealed');

                if (userAnswer === correctAnswer) {
                    input.classList.add('correct');
                    correctAnswers++;
                } else if (userAnswer !== '') {
                    input.classList.add('wrong');
                    // Mostra la risposta corretta
                    input.value = input.getAttribute('data-verb');
                    input.classList.add('revealed');
                } else {
                    // Campo vuoto, mostra la risposta
                    input.value = input.getAttribute('data-verb');
                    input.classList.add('revealed');
                }
                
                // Disabilita l'input
                input.disabled = true;
            });

            // Aggiorna il punteggio
            const numberOfVerbs = parseInt(localStorage.getItem("numberOfVerbs")) || 10;
            score = Math.round((correctAnswers / totalAnswers) * numberOfVerbs);
            document.getElementById("score").innerText = `Score: ${correctAnswers}/${numberOfVerbs}`;

            // Ferma il timer
            stopStopwatch();
            isTimerRunning = false;

            // Mostra risultato
            showResultModal(correctAnswers, numberOfVerbs);
            
            // Mostra bottoni di fine gioco
            showEndGameButtons();
        }

        function showResultModal(correct, total) {
            const percentage = Math.round((correct / total) * 100);
            let title, message, type;

            if (percentage >= 90) {
                title = "🏆 Eccellente!";
                message = `Hai risposto correttamente a ${correct} su ${total} domande (${percentage}%). Complimenti!`;
                type = "success";
            } else if (percentage >= 70) {
                title = "👍 Molto Bene!";
                message = `Hai risposto correttamente a ${correct} su ${total} domande (${percentage}%). Buon lavoro!`;
                type = "success";
            } else if (percentage >= 50) {
                title = "📚 Da Migliorare";
                message = `Hai risposto correttamente a ${correct} su ${total} domande (${percentage}%). Continua a studiare!`;
                type = "warning";
            } else {
                title = "💪 Non Mollare!";
                message = `Hai risposto correttamente a ${correct} su ${total} domande (${percentage}%). Riprova, ce la puoi fare!`;
                type = "error";
            }

            showModal(title, message, type);
        }

        function giveUp() {
            const inputs = document.querySelectorAll('.verb-input');
            
            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.value = input.getAttribute('data-verb');
                    input.classList.add('revealed');
                }
                input.disabled = true;
            });

            stopStopwatch();
            isTimerRunning = false;
            showEndGameButtons();
            
            // Calcola comunque il punteggio delle risposte corrette
            let correctAnswers = 0;
            inputs.forEach(input => {
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = input.getAttribute('data-verb').toLowerCase();
                if (userAnswer === correctAnswer && !input.classList.contains('revealed')) {
                    correctAnswers++;
                    input.classList.add('correct');
                }
            });

            const numberOfVerbs = parseInt(localStorage.getItem("numberOfVerbs")) || 10;
            document.getElementById("score").innerText = `Score: ${correctAnswers}/${numberOfVerbs}`;
            
            showModal("😓 Test Terminato", "Hai visualizzato tutte le risposte. Studia e riprova!", "warning");
        }

        function startAgain() {
            // Reset variabili
            score = 0;
            elapsedTime = 0;
            isTimerRunning = true;
            
            // Reset timer button
            const timerButton = document.getElementById("toggle-timer");
            timerButton.innerHTML = "⏸️ Pausa";
            timerButton.className = "btn-control btn-pause";
            
            // Nascondi modal se aperto
            hideModal();
            
            // Riavvia il gioco
            startGame();
            showGameButtons();
        }

        function showModal(title, message, type = "success") {
            const modal = document.getElementById("message-modal");
            const modalTitle = document.getElementById("modal-title");
            const modalText = document.getElementById("modal-text");

            modalTitle.textContent = title;
            modalText.textContent = message;
            
            modal.className = `modal ${type} fade-in`;
            modal.classList.remove("hidden");

            // Auto-hide dopo 4 secondi
            setTimeout(() => {
                hideModal();
            }, 4000);

            // Click per chiudere
            modal.onclick = function(e) {
                if (e.target === modal) {
                    hideModal();
                }
            };
        }

        function hideModal() {
            const modal = document.getElementById("message-modal");
            modal.classList.add("fade-out");
            setTimeout(() => {
                modal.classList.add("hidden");
                modal.classList.remove("fade-in", "fade-out");
                modal.className = "modal hidden";
            }, 300);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (!document.getElementById("check-answers").classList.contains("hidden")) {
                        checkAnswers();
                    }
                } else if (e.key === ' ') {
                    e.preventDefault();
                    if (!document.getElementById("toggle-timer").classList.contains("hidden")) {
                        toggleTimer();
                    }
                }
            }
            
            if (e.key === 'Escape') {
                hideModal();
            }
        });

        // Previeni il refresh accidentale durante il test
        window.addEventListener('beforeunload', function (e) {
            if (!document.getElementById("control-panel").classList.contains("hidden") && 
                !document.getElementById("start-again").classList.contains("hidden") === false) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>
